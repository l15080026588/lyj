webpackJsonp([9],{"0OPg":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});t("mtWM");const r=/^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199|(147))\d{8}$/;var i={data:()=>({register:{userName:"",userType:"",userPass:"",userTel:"",studyNumber:""},codes:"",getcodes:"1111",disabled:!1,time:0,btntxt:"重新发送",checkPass:"",rules:{userName:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:4,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],userPass:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}],userTel:[{validator:(e,s,t)=>{if(!s)return t(new Error("手机号不能为空"));{const e=/^1[3|4|5|7|8][0-9]\d{8}$/;if(console.log(e.test(s)),!e.test(s))return t(new Error("请输入正确的手机号"));t()}},trigger:"blur"}]}}),methods:{submitForm(e){if(r.test(this.register.userTel)){if(this.getcodes.toLowerCase()!=this.codes.toLowerCase())return this.$message.error("验证码有误"),void(this.codes="");this.$axios({method:"post",url:"/api/users_info/regist",data:{name:this.register.userName,role:this.register.userType,studyNumber:this.register.studyNumber,telphone:this.register.userTel,pass:this.register.userPass}}).then(e=>{console.log(e),204==e.status&&(this.$message.error("该手机号已注册"),this.register.userName="",this.register.userType="",this.register.studyNumber="",this.register.userTel="",this.register.userPass="",this.ruleForm.checkPass=""),201==e.status&&(this.$message({message:"注册成功",iconClass:"icon icon-success",duration:1e3}),this.$router.push("/"))}).catch(function(e){console.log(e)})}},sendcode(){console.log(this.register.userTel),/^((13|14|15|17|18)[0-9]{1}\d{8})$/.test(this.register.userTel)?(console.log(this.register.userTel),this.$message({message:"发送成功",type:"success",center:!0}),this.time=60,this.disabled=!0,this.timer(),this.$axios({method:"post",url:"/api/sms",data:{mobile:this.register.userTel}}).then(e=>{console.log(e),200==e.data.state?(this.getcodes=e.data.code,this.$message({message:"获取成功",type:"success",center:!0})):500==e.data.state&&this.$message({message:"获取失败",center:!0})})):this.$message({message:"请输入正确的手机号",center:!0})},timer(){this.time>0?(this.time--,this.btntxt=this.time+"s后重新获取",setTimeout(this.timer,1e3)):(this.time=0,this.btntxt="获取验证码",this.disabled=!1)}}},a={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"register"},[t("div",{staticClass:"register-contant"},[t("section",{staticClass:"form-contant"},[e._m(0),e._v(" "),t("el-form",{ref:"registerForm",staticClass:"registerForm",attrs:{model:e.register,rules:e.rules}},[t("el-form-item",{attrs:{prop:"userName"}},[t("el-input",{attrs:{label:"姓名",placeholder:"请输入名字"},model:{value:e.register.userName,callback:function(s){e.$set(e.register,"userName",s)},expression:"register.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"userType"}},[t("el-select",{attrs:{placeholder:"请选择用户类型"},model:{value:e.register.userType,callback:function(s){e.$set(e.register,"userType",s)},expression:"register.userType"}},[t("el-option",{attrs:{label:"学生",value:"student"}}),e._v(" "),t("el-option",{attrs:{label:"教师",value:"teacher"}}),e._v(">\n                ")],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"studyNumber"}},[t("el-input",{attrs:{label:"学/工号",placeholder:"请输入学/工号"},model:{value:e.register.studyNumber,callback:function(s){e.$set(e.register,"studyNumber",s)},expression:"register.studyNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"userTel"}},[t("el-input",{attrs:{label:"手机号",placeholder:"请输入手机号"},model:{value:e.register.userTel,callback:function(s){e.$set(e.register,"userTel",s)},expression:"register.userTel"}})],1),e._v(" "),t("el-form-item",{staticClass:"code",attrs:{prop:"codes"}},[t("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.codes,callback:function(s){e.codes=s},expression:"codes"}}),e._v(" "),0==e.disabled?t("el-button",{attrs:{type:"button",disabled:e.disabled},on:{click:e.sendcode}},[e._v("发送验证码\n                  ")]):e._e(),e._v(" "),1==e.disabled?t("el-button",{attrs:{type:"button",disabled:e.disabled},on:{click:e.sendcode}},[e._v(e._s(e.btntxt)+"\n                  ")]):e._e()],1),e._v(" "),t("el-form-item",{staticClass:"passw",attrs:{prop:"userPass"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock"},model:{value:e.register.userPass,callback:function(s){e.$set(e.register,"userPass",s)},expression:"register.userPass"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"checkPass"}},[t("el-input",{attrs:{type:"password",placeholder:"请再次输入密码","prefix-icon":"el-icon-lock"},model:{value:e.checkPass,callback:function(s){e.checkPass=s},expression:"checkPass"}})],1),e._v(" "),t("el-form-item",[t("el-button",{staticClass:"submit_btn",attrs:{type:"primary"},on:{click:function(s){e.submitForm("registerForm")}}},[e._v("注 册")])],1)],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"manage_tip"},[s("span",{staticClass:"title"},[this._v("用户注册")])])}]};var l=t("VU/8")(i,a,!1,function(e){t("7VCw")},null,null);s.default=l.exports},"7VCw":function(e,s){}});